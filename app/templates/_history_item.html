<li class="list-group-item p-3">
  <div class="d-flex justify-content-between align-items-start">
      
      <div class="flex-grow-1">
        <div class="d-flex align-items-center gap-2 mb-1">
            {% if post.scheduled_at and post.status == 'scheduled' %}
              <span class="badge bg-warning text-dark"><i class="bi bi-hourglass-split"></i> Запланирован</span>
              <small class="text-muted ms-1">на <span class="time utc-timestamp">{{ post.scheduled_at.isoformat() }}Z</span></small>
            {% elif post.published_at %}
              <span class="badge bg-success"><i class="bi bi-check-lg"></i> Опубликован</span>
              <small class="text-muted ms-1"><span class="time utc-timestamp">{{ post.published_at.isoformat() }}Z</span></small>
            {% elif post.status == 'failed' %}
              <span class="badge bg-danger"><i class="bi bi-exclamation-octagon"></i> Ошибка</span>
              <small class="text-muted ms-1">запланировано на <span class="time utc-timestamp">{{ post.scheduled_at.isoformat() + 'Z' if post.scheduled_at else 'N/A' }}</span></small>
            {% else %}
               <span class="badge bg-info"><i class="bi bi-arrow-repeat"></i> В обработке</span>
            {% endif %}
        </div>

        <div class="text text-break my-2" style="white-space: pre-wrap; font-size: 0.95rem;">{{ (post.text_vk or '') | truncate(200) }}</div>
        
        {% if post.error_message %}
            <div class="alert alert-danger py-1 px-2 d-inline-block small mb-2">
                <i class="bi bi-bug me-1"></i> {{ post.error_message }}
            </div>
        {% endif %}
        
        <div class="d-flex gap-1 opacity-75">
          {% if post.publish_to_tg %}<span class="badge bg-primary rounded-pill"><i class="bi bi-telegram"></i></span>{% endif %}
          {% if post.publish_to_vk %}<span class="badge bg-primary bg-opacity-75 rounded-pill" style="background-color: #0077FF !important;"><span class="fw-bold" style="font-size: 0.8em">VK</span></span>{% endif %}
          {% if post.publish_to_ig %}<span class="badge bg-danger rounded-pill"><i class="bi bi-instagram"></i></span>{% endif %}
          {% if post.publish_to_max %}<span class="badge bg-warning text-dark rounded-pill"><i class="bi bi-robot"></i></span>{% endif %}
        </div>
      </div>

      <div class="d-flex flex-column gap-2 ms-3">
          <button class="btn btn-sm btn-outline-secondary" 
                  type="button"
                  title="Клонировать"
                  onclick='clonePost({{ post.text | tojson | safe }})'>
              <i class="bi bi-files"></i>
          </button>
          <form method="post" action="{{ url_for('main.delete', post_id=post.id) }}">
            <button class="btn btn-sm btn-outline-danger border-0"
                    title="Удалить"
                    onclick="return confirm('Удалить пост?')"><i class="bi bi-trash"></i></button>
          </form>
      </div>
  </div>
</li>